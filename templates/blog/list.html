<!DOCTYPE html>
<html lang="ko" class="h-full" data-page="blog-list">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>블로그 - CareBridge</title>
    <meta name="description" content="요양시설 인사이트 & 케어 관련 매거진 스타일 블로그">
    <meta property="og:title" content="블로그 - CareBridge"/>
    <meta property="og:description" content="요양시설 인사이트 & 케어 관련 매거진 스타일 블로그"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="{{ request.build_absolute_uri }}"/>
    <meta property="og:image" content="{% if featured and featured.cover_image %}{{ featured.cover_image.url }}{% endif %}"/>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body{font-family:'Pretendard',-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Helvetica Neue',Arial,sans-serif;}
        .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
        .line-clamp-3{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;}
        .focus-ring:focus{outline:2px solid #6366f1;outline-offset:2px;}
        .img-hover{transition:transform .5s ease, box-shadow .4s ease;} .group:hover .img-hover{transform:scale(1.03);}
        .hdr{transition:height .2s ease, box-shadow .2s ease, background .2s ease;}
        .hdr:not(.shrink){height:70px;} .hdr.shrink{height:56px;}
        .tag-overlay span{background:rgba(0,0,0,.55);color:#fff;backdrop-filter:blur(4px);}
    </style>
</head>
<body class="min-h-full bg-white text-slate-900 antialiased selection:bg-indigo-200/60">
<header id="siteHeader" class="hdr sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-200 flex flex-col justify-center">{% include 'core/_navbar.html' %}</header>
<main class="max-w-7xl mx-auto px-5 py-10">
    <div class="flex flex-col gap-10">
        <!-- 상단: 카테고리 필터 (태그 필터 제거) -->
        <div class="flex flex-wrap gap-3 items-center">
            <a href="{% url 'blog:list' %}" class="px-3 py-1.5 rounded-full text-xs font-medium border transition {% if not current_category %}bg-slate-800 text-white border-slate-800{% else %}border-slate-300 bg-slate-100 text-slate-600 hover:border-slate-500{% endif %}">전체</a>
            {% for cat in categories %}
            <a href="?category={{ cat.slug }}" class="px-3 py-1.5 rounded-full text-xs font-medium border transition {% if cat.slug == current_category %}bg-slate-800 text-white border-slate-800{% else %}border-slate-300 bg-slate-100 text-slate-600 hover:border-slate-500{% endif %}">{{ cat.name }}</a>
            {% endfor %}
        </div>

        <!-- 포스트 카드 (3열) -->
        <section aria-label="포스트 목록" class="grid sm:grid-cols-2 xl:grid-cols-3 gap-6">
            {% for p in posts %}
            <article class="group rounded-2xl bg-white border border-slate-200 shadow-sm overflow-hidden flex flex-col transition hover:shadow-md focus-within:shadow-md">
                <a href="{{ p.get_absolute_url }}" class="block relative aspect-video overflow-hidden">
                    {% if p.cover_image %}<img src="{{ p.cover_image.url }}" alt="{{ p.title }}" class="w-full h-full object-cover img-hover" loading="lazy">{% else %}<div class="w-full h-full flex items-center justify-center bg-gradient-to-br from-slate-100 to-slate-200 text-slate-400 text-xs">NO IMAGE</div>{% endif %}
                    <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent"></div>
                    <div class="absolute left-2 bottom-2 flex flex-wrap gap-1 tag-overlay">
                        {% if p.is_featured %}<span class="px-2 py-0.5 rounded-full text-[10px] font-semibold bg-indigo-600 text-white shadow">FEATURED</span>{% endif %}
                        {% for t in p.tags.all|slice:':2' %}<span class="px-2 py-0.5 rounded-full text-[10px] font-medium">{{ t.name }}</span>{% endfor %}
                        {% if p.category %}<span class="px-2 py-0.5 rounded-full text-[10px] font-semibold bg-white/90 text-slate-800 backdrop-blur">{{ p.category.name }}</span>{% endif %}
                    </div>
                </a>
                <div class="flex-1 flex flex-col p-5 gap-3">
                    <h3 class="font-semibold leading-snug text-slate-800 line-clamp-2"><a href="{{ p.get_absolute_url }}" class="hover:underline decoration-2 underline-offset-4">{{ p.title }}</a></h3>
                    <p class="text-[13px] leading-relaxed text-slate-600 line-clamp-2">{{ p.excerpt }}</p>
                    <div class="mt-auto flex items-center justify-between text-[11px] text-slate-500">
                        <span>{{ p.published_at|date:'Y.m.d' }}</span>
                    </div>
                </div>
            </article>
            {% empty %}
            <div class="col-span-full py-20 text-center text-slate-500">포스트가 없습니다.</div>
            {% endfor %}
        </section>

        {% if page_obj.has_other_pages %}
        <nav class="flex justify-center pt-4" aria-label="페이지네이션">
            <ul class="flex items-center gap-1 text-sm">
                {% if page_obj.has_previous %}
                <li><a class="px-3 h-9 inline-flex items-center justify-center rounded-lg border border-slate-300 hover:border-slate-500" href="?page={{ page_obj.previous_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}" aria-label="이전 페이지">«</a></li>
                {% endif %}
                {% for num in page_obj.paginator.page_range %}
                    {% if num == page_obj.number %}
                    <li><span class="px-3 h-9 inline-flex items-center justify-center rounded-lg bg-indigo-600 text-white font-medium">{{ num }}</span></li>
                    {% elif num >= page_obj.number|add:'-2' and num <= page_obj.number|add:'2' %}
                    <li><a class="px-3 h-9 inline-flex items-center justify-center rounded-lg border border-slate-300 hover:border-slate-500" href="?page={{ num }}{% if current_category %}&category={{ current_category }}{% endif %}">{{ num }}</a></li>
                    {% endif %}
                {% endfor %}
                {% if page_obj.has_next %}
                <li><a class="px-3 h-9 inline-flex items-center justify-center rounded-lg border border-slate-300 hover:border-slate-500" href="?page={{ page_obj.next_page_number }}{% if current_category %}&category={{ current_category }}{% endif %}" aria-label="다음 페이지">»</a></li>
                {% endif %}
            </ul>
        </nav>
        {% endif %}
    </div>
</main>
{% include 'core/_footer.html' %}
<script>
// 헤더 shrink & shadow
const header=document.getElementById('siteHeader');function onScroll(){if(window.scrollY>16){header.classList.add('shrink','shadow-sm');}else{header.classList.remove('shrink','shadow-sm');}}window.addEventListener('scroll',onScroll);onScroll();
</script>
</body>
</html>
